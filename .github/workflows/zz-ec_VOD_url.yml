name: zz-EC VOD URLs

on:
  workflow_dispatch:
    inputs:
      input_file:
        description: '/program/temp/VOD_to_fetch.txt'
        required: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2

    - name: Configure Git
      run: |
        git config --global user.email "action@github.com"
        git config --global user.name "GitHub Action"

    - name: Prepare Input File
      run: |
        # Copy source contents to a temp file
        cp ./program/VOD_to_fetch.txt ./program/temp/VOD_to_fetch_temp.txt
        # Replace ", " with ","
        sed -i 's/, /,/g' ./program/temp/VOD_to_fetch_temp.txt

    - name: Process VOD URLs
      run: |
        set +e  # Disable exit-on-error temporarily
        while IFS=, read -r channel_name group video_url image_url; do
          # Trim leading and trailing spaces from the group variable
          group=$(echo "$group" | tr -d ' ')
          # Rest of the script remains the same
          # ...

        done < "/program/temp/VOD_to_fetch_temp.txt"
        set -e  # Enable exit-on-error again

    - name: Commit and Push Changes
      run: |
        git add ./program/temp/VOD_to_fetch_temp.txt
        git add ./vod
        git commit -m "Update vod files"
        git push -f  # Force push changes

        # Note: Force-pushing can be risky, make sure you understand the implications
